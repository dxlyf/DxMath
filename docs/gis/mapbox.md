å½“ç„¶å¯ä»¥ï¼Œä»¥ä¸‹æ˜¯ **Mapbox GL JS** çš„æ ¸å¿ƒå¯¹è±¡ã€ç±»ä¸æ¨¡å—ç»“æ„ï¼ŒæŒ‰åŠŸèƒ½å½’ç±»ï¼Œé€‚ç”¨äºä½ å¼€å‘ WebGIS é¡¹ç›®æ—¶å¿«é€ŸæŸ¥æ‰¾ä¸ç†è§£ã€‚

---

## âœ… Mapbox GL JS æ ¸å¿ƒå¯¹è±¡æ€»è§ˆ

> Mapbox GL JS æ˜¯åŸºäº **WebGL çš„çŸ¢é‡åœ°å›¾æ¸²æŸ“å¼•æ“**ï¼Œä½¿ç”¨ Style-Spec é©±åŠ¨ï¼Œæ ¸å¿ƒå¯¹è±¡æ¯” OpenLayers å°‘ä½†æ›´é«˜åº¦å°è£…ã€‚

---

### ğŸ—ºï¸ 1. åœ°å›¾åŸºç¡€å¯¹è±¡

| ç±»å                            | è¯´æ˜                                   |
| ----------------------------- | ------------------------------------ |
| `mapboxgl.Map`                | åœ°å›¾å®ä¾‹å¯¹è±¡ï¼Œè´Ÿè´£æ¸²æŸ“ã€äº¤äº’ã€å›¾å±‚ç®¡ç†ç­‰                 |
| `mapboxgl.ViewState`          | è§†å›¾çŠ¶æ€ï¼ˆå†…éƒ¨ç®¡ç† center/zoom/pitch/bearingï¼‰ |
| `mapboxgl.Popup`              | å¼¹å‡ºçª—å£ï¼ˆæç¤ºä¿¡æ¯ã€æ°”æ³¡ï¼‰                        |
| `mapboxgl.Marker`             | è‡ªå®šä¹‰æ ‡æ³¨ï¼ˆéçŸ¢é‡å›¾å±‚ï¼‰                         |
| `mapboxgl.NavigationControl`  | æ”¾å¤§/ç¼©å°/ç½—ç›˜æ§ä»¶                           |
| `mapboxgl.ScaleControl`       | æ¯”ä¾‹å°ºæ§ä»¶                                |
| `mapboxgl.FullscreenControl`  | å…¨å±æŒ‰é’®                                 |
| `mapboxgl.GeolocateControl`   | å®šä½æ§ä»¶                                 |
| `mapboxgl.AttributionControl` | ç‰ˆæƒä¿¡æ¯æ§ä»¶                               |

---

### ğŸ—‚ï¸ 2. å›¾å±‚ï¼ˆLayerï¼‰

å›¾å±‚ä¸é€šè¿‡ç±»å®ä¾‹åŒ–ï¼Œè€Œæ˜¯ç”¨ JSON é…ç½®æ·»åŠ ï¼ˆç¬¦åˆ Mapbox Style Specï¼‰ï¼š

```js
map.addLayer({
  id: 'my-layer',
  type: 'circle', // æˆ– 'fill' | 'line' | 'symbol' | 'heatmap' | ...
  source: 'my-source',
  paint: { ... },
  layout: { ... }
});
```

#### å¸¸è§å›¾å±‚ç±»å‹ï¼ˆ`type`ï¼‰ï¼š

| ç±»å‹               | ç”¨é€”                   |
| ---------------- | -------------------- |
| `fill`           | é¢å¡«å……ï¼ˆå¤šè¾¹å½¢ï¼‰             |
| `line`           | çº¿                    |
| `circle`         | ç‚¹ï¼ˆåœ†ï¼‰                 |
| `symbol`         | å›¾æ ‡ + æ–‡æœ¬æ ‡æ³¨            |
| `heatmap`        | çƒ­åŠ›å›¾                  |
| `fill-extrusion` | 3D å»ºç­‘ä½“ç§¯              |
| `raster`         | æ …æ ¼ç“¦ç‰‡å›¾å±‚ï¼ˆXYZã€TMSã€WMTSï¼‰ |
| `background`     | èƒŒæ™¯å¡«å……                 |
| `hillshade`      | é˜´å½±åœ°å½¢                 |

---

### ğŸ§± 3. æ•°æ®æºï¼ˆSourceï¼‰

ä¸ Layer é…åˆï¼Œç”¨äºæä¾›æ•°æ®è¾“å…¥ï¼Œæ”¯æŒå¤šç§æ ¼å¼ï¼š

| ç±»å‹           | ç±»å / å­—ç¬¦ä¸²         | æè¿°                  |
| ------------ | ---------------- | ------------------- |
| `geojson`    | å†…è”æˆ– URL          | åŠ è½½ GeoJSON æ•°æ®ï¼ˆå¯äº¤äº’ï¼‰  |
| `vector`     | MVT ç“¦ç‰‡æº          | åŠ è½½çŸ¢é‡ç“¦ç‰‡ï¼ˆ`.pbf`ï¼‰      |
| `raster`     | XYZ / TMS / WMTS | æ …æ ¼åœ°å›¾ç“¦ç‰‡              |
| `raster-dem` | åœ°å½¢å›¾ï¼ˆDEM é«˜ç¨‹ï¼‰      | ç”¨äºåœ°å½¢ã€hillshade æˆ– 3D |
| `image`      | å•å¼ å›¾åƒ             | è‡ªå®šä¹‰å›¾ç‰‡è¦†ç›–åŒºåŸŸ           |
| `video`      | è§†é¢‘è¦†ç›–åŒºåŸŸ           |                     |

---

### ğŸ“ 4. åœ°ç†åæ ‡ä¸æŠ•å½±

| åç§°        | æ”¯æŒæƒ…å†µ                                                                           |
| --------- | ------------------------------------------------------------------------------ |
| EPSG:4326 | âœ… æ”¯æŒï¼ˆç»çº¬åº¦è¾“å…¥ï¼‰                                                                    |
| EPSG:3857 | âœ… å†…éƒ¨æŠ•å½±ï¼ˆWeb Mercatorï¼‰                                                           |
| è‡ªå®šä¹‰æŠ•å½±     | âœ… Mapbox GL v2 æ”¯æŒï¼ˆä½¿ç”¨ `setProjection()`ï¼‰<br>æ”¯æŒ globeã€mercatorã€equirectangular ç­‰ |

```js
map.setProjection('globe'); // åœ°çƒè§†å›¾
```

---

### ğŸ§© 5. äº¤äº’åŠŸèƒ½ï¼ˆäº‹ä»¶ä¸æ–¹æ³•ï¼‰

Mapbox GL æä¾›ä¸°å¯Œäº¤äº’æ–¹å¼ï¼š

| åŠŸèƒ½     | ç¤ºä¾‹æ–¹æ³•æˆ–äº‹ä»¶                                 |
| ------ | --------------------------------------- |
| ç‚¹å‡»åœ°å›¾è¦ç´  | `map.on('click', 'layer-id', callback)` |
| é¼ æ ‡æ‚¬åœé«˜äº® | `mouseenter` / `mouseleave`             |
| æ‹–åŠ¨åœ°å›¾   | é»˜è®¤æ”¯æŒ                                    |
| æ·»åŠ å¼¹çª—   | `new mapboxgl.Popup()`                  |
| é£è¡ŒåŠ¨ç”»   | `map.flyTo({ center, zoom })`           |
| ç”»å›¾     | ä½¿ç”¨ `@mapbox/mapbox-gl-draw` æ’ä»¶å®ç°        |
| å›¾å±‚ç­›é€‰   | `map.setFilter(layerId, filterExpr)`    |

---

### ğŸ¨ 6. æ ·å¼æ§åˆ¶ï¼ˆPaint/Layoutï¼‰

* **Paint**ï¼šæ§åˆ¶å›¾å±‚çš„æ ·å¼ï¼ˆé¢œè‰²ã€å®½åº¦ã€é€æ˜åº¦ç­‰ï¼‰
* **Layout**ï¼šæ§åˆ¶å›¾å±‚çš„å¸ƒå±€ï¼ˆæ˜¯å¦æ˜¾ç¤ºã€å›¾æ ‡åç§»ç­‰ï¼‰

```js
map.setPaintProperty('my-layer', 'circle-radius', 10);
map.setLayoutProperty('my-layer', 'visibility', 'none');
```

---

### ğŸ”Œ 7. æ’ä»¶ç”Ÿæ€ï¼ˆç¬¬ä¸‰æ–¹ç»„ä»¶ï¼‰

| æ’ä»¶                           | åŠŸèƒ½              |
| ---------------------------- | --------------- |
| `@mapbox/mapbox-gl-draw`     | ç»˜åˆ¶ç‚¹ã€çº¿ã€é¢         |
| `@mapbox/mapbox-gl-geocoder` | åœ°ç†ç¼–ç ï¼ˆæœç´¢åœ°å€ï¼‰      |
| `mapbox-gl-scale`            | æ¯”ä¾‹å°º             |
| `mapbox-gl-language`         | å›½é™…åŒ–è¯­è¨€æ”¯æŒ         |
| `deck.gl`                    | é«˜æ€§èƒ½ WebGL å¯è§†åŒ–å åŠ  |
| `turf.js`                    | ç©ºé—´åˆ†æï¼ˆç¼“å†²ã€ç›¸äº¤ã€æµ‹è·ç­‰ï¼‰ |

---

### ğŸ” 8. Mapbox æ ¸å¿ƒä¾èµ–

| æ¨¡å—              | ç”¨é€”                                                                                                                |
| --------------- | ----------------------------------------------------------------------------------------------------------------- |
| `mapbox-gl`     | ä¸»åº“                                                                                                                |
| `Mapbox Studio` | å¯è§†åŒ–é…ç½®æ ·å¼                                                                                                           |
| `Style Spec`    | æ ·å¼è¯­è¨€ JSON è§„èŒƒï¼š[https://docs.mapbox.com/mapbox-gl-js/style-spec/](https://docs.mapbox.com/mapbox-gl-js/style-spec/) |

---

## âœ… å…¸å‹ Mapbox GL JS å¯¹è±¡å…³ç³»å›¾ï¼ˆç®€åŒ–ï¼‰

```
Map
 â”œâ”€ Sources (geojson / vector / raster / ...)
 â”œâ”€ Layers (fill / line / symbol / circle / ...)
 â”œâ”€ Controls (Navigation / Scale / Fullscreen / ...)
 â”œâ”€ Interactions (popup / click / draw / ...)
 â”œâ”€ Markers / Popups / Overlays
 â””â”€ Style (Paint / Layout / Filter / Transition)
```

---

## ğŸ¯ æ€»ç»“å»ºè®®ï¼ˆé¢è¯•æˆ–é¡¹ç›®åº”ç”¨ï¼‰

| åœºæ™¯             | æ¨èåšæ³•                                         |
| -------------- | -------------------------------------------- |
| åŠ è½½ GeoJSON ç‚¹å›¾å±‚ | ä½¿ç”¨ `geojson` æº + `circle` æˆ– `symbol` å›¾å±‚      |
| åŠ è½½æ …æ ¼ç“¦ç‰‡åº•å›¾       | ä½¿ç”¨ `raster` æº + `raster` å›¾å±‚                  |
| å®ç°ç‚¹å‡»å¼¹çª—         | ä½¿ç”¨ `map.on('click', layerId, ...)` + `Popup` |
| æ§åˆ¶å›¾å±‚æ˜¾ç¤º         | ä½¿ç”¨ `map.setLayoutProperty` æˆ– `setFilter`     |
| æ”¯æŒç»˜å›¾           | å¼•å…¥ `@mapbox/mapbox-gl-draw` æ’ä»¶               |

---

å¦‚æœä½ éœ€è¦æˆ‘æä¾›ï¼š

* ä¸€ä¸ªå®Œæ•´çš„ Mapbox GL JS + React ç¤ºä¾‹ç»„ä»¶
* æˆ–è€…é…ç½®è‡ªå®šä¹‰æ ·å¼ / ä¸­å¿ƒç‚¹ / åœ°å›¾æ§ä»¶
* æˆ–è€…ä»‹ç»å¦‚ä½•åŠ è½½ä½ è‡ªå·±çš„çŸ¢é‡ç“¦ç‰‡æœåŠ¡å™¨

æ¬¢è¿ç»§ç»­æé—®ï¼Œæˆ‘å¯ä»¥æä¾›ç”Ÿäº§çº§ç¤ºä¾‹æˆ–æ¨¡æ¿ã€‚
